# üîê Keycloak: –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

## üåü –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞

### 1. üè∑Ô∏è General Settings (–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| **Client ID*** | `my_app` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è) |
| **Name** | –ú–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ) |
| **Description** | –ü—Ä–æ–¥–∞–∫—à–µ–Ω –≤–µ—Ä—Å–∏—è | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ |
| **Always display in UI** | ‚ùå Off | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–∞—Ö, –∫–æ–≥–¥–∞ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

### 2. üåê Access Settings (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü—Ä–∏–º–µ—Ä | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|----------|--------|----------------------|
| **Root URL** | `https://shop.example.com` | –ë–∞–∑–æ–≤—ã–π URL –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| **Home URL** | `https://shop.example.com/home` | –°—Å—ã–ª–∫–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (–¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥") |
| **Valid redirect URIs*** | `https://shop.example.com/auth/callback` | –¢–æ—á–Ω—ã–µ URI –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| **Valid post logout URIs** | `https://shop.example.com/logout/success` | –ö—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã |
| **Web origins** | `https://shop.example.com` | –î–æ–º–µ–Ω –¥–ª—è CORS-–∑–∞–ø—Ä–æ—Å–æ–≤ (–±–µ–∑ / –Ω–∞ –∫–æ–Ω—Ü–µ) |

#### üî• –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è Web Origins:
```text
*                        - –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ –¥–æ–º–µ–Ω—ã (–æ–ø–∞—Å–Ω–æ –¥–ª—è prod)
https://example.com      - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω
https://*.example.com    - –í—Å–µ –ø–æ–¥–¥–æ–º–µ–Ω—ã example.com
https://shop.example.com https://api.example.com - –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–æ–≤
```

## 3. ‚öôÔ∏è Capability Config

| –ü–∞—Ä–∞–º–µ—Ç—Ä                     | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è | –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω?                                   |
|------------------------------|--------------|---------------------------------------------------|
| Client authentication         | ‚úÖ On        | –¢—Ä–µ–±–æ–≤–∞—Ç—å –ª–∏ client_secret –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏     |
| Authorization                 | ‚ùå Off       | –í–∫–ª—é—á–∏—Ç—å fine-grained –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ)|

## 4. üîÑ Authentication Flows

| –ü–æ—Ç–æ–∫                     | –í–∫–ª? | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                               |
|--------------------------|------|-------------------------------------------------|
| Standard flow            | ‚úÖ   | –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (OAuth 2.0 Authorization Code)  |
| Direct access grants     | ‚úÖ   | –ú–æ–±–∏–ª—å–Ω—ã–µ/–¥–µ—Å–∫—Ç–æ–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                     |
| Implicit flow            | ‚ùå   | –£—Å—Ç–∞—Ä–µ–≤—à–∏–π (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)                       |
| Service accounts         | ‚ùå   | –î–ª—è machine-to-machine –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏              |
| Device flow              | ‚ùå   | –£–º–Ω—ã–µ TV/–ø—Ä–∏–Ω—Ç–µ—Ä—ã                               |
| CIBA                     | ‚ùå   | –ë–µ—Å—à—É–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è                         |

## 5. üö™ Logout Settings (–ü–æ–¥—Ä–æ–±–Ω–æ)

| –ü–∞—Ä–∞–º–µ—Ç—Ä                     | –ü—Ä–∏–º–µ—Ä                                   | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                                      |
|------------------------------|------------------------------------------|------------------------------------------------|
| Front channel logout         | ‚úÖ On                                   | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã—Ö–æ–¥ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä                 |
| Front-channel logout URL     | https://app.com/logout                  | URL –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞                     |
| Backchannel logout           | ‚úÖ On                                   | –°–µ—Ä–≤–µ—Ä–Ω—ã–π –≤—ã—Ö–æ–¥ (–±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)      |
| Backchannel logout URL       | https://api.app.com/bclogout           | –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞                  |
| Backchannel session required  | ‚úÖ On                                   | –¢—Ä–µ–±–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é                       |
| Revoke offline sessions      | ‚ùå Off                                  | –û—Ç–∑—ã–≤–∞—Ç—å offline-—Ç–æ–∫–µ–Ω—ã (—Ä–µ–¥–∫–æ –Ω—É–∂–Ω–æ)          |



üõ†Ô∏è –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
1. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (React/Angular)
```yaml
Client ID: web_app
Root URL: https://myapp.com
Valid redirect URIs:
  - https://myapp.com/auth/callback
  - https://myapp.com/silent-renew.html
Web origins: https://myapp.com
Standard flow: ‚úÖ On
Implicit flow: ‚ùå Off
```


2. –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Android/iOS)
```yaml
Client ID: mobile_app
Valid redirect URIs:
  - com.myapp://oauthredirect
  - io.identityserver.demo:/oauthredirect
Public client: ‚úÖ On
Direct access: ‚úÖ On
```

üö® –í–∞–∂–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ * –≤ Valid Redirect URIs –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
–î–ª—è SPA-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PKCE (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ –≤–∫–ª–∞–¥–∫–µ Credentials)
–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ client_secret (—Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤)
–î–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) –æ—Ç–∫–ª—é—á–∞–π—Ç–µ client authentication
